<app-component-card title="Fridge">

    <div class="space-y-4">
        <h2 class="text-xl font-semibold">Mes produits</h2>

        <div *ngIf="loading">Chargement...</div>
        <div *ngIf="errorMessage" class="text-red-500">{{ errorMessage }}</div>

        <div *ngIf="!loading && products.length > 0">
            <!-- Filtre par catégorie -->
            <div class="mb-4">
                <label for="category" class="mr-2 font-medium">Filtrer par catégorie:</label>
                <select id="category" [(ngModel)]="selectedCategory" (change)="applyFilter()"
                    class="border p-1 rounded">
                    <option value="">Toutes</option>
                    <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
                </select>
            </div>

            <!-- Liste des produits -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div *ngFor="let product of paginatedProducts" class="border p-4 rounded-lg shadow">
                    <h3 class="font-bold text-lg">{{ product.name }}</h3>
                    <p>Quantité: {{ product.quantity }}</p>
                    <p>Catégorie: {{ product.category }}</p>
                    <p>Date d’expiration: {{ product.expiryDate | date:'shortDate' }}</p>
                    <div *ngIf="product.image">
                        <img [src]="'http://localhost:3000/uploads/' + product.image" alt="{{ product.name }}" />
                    </div>
                </div>
            </div>

            <!-- Pagination -->
            <div class="flex justify-center items-center mt-4 space-x-2">
                <button (click)="prevPage()" [disabled]="currentPage === 1"
                    class="px-3 py-1 border rounded">Précédent</button>
                <span>Page {{ currentPage }} / {{ totalPages }}</span>
                <button (click)="nextPage()" [disabled]="currentPage * itemsPerPage >= filteredProducts.length"
                    class="px-3 py-1 border rounded">Suivant</button>
            </div>
        </div>

        <div *ngIf="!loading && products.length === 0">
            Aucun produit trouvé.
        </div>
    </div>

</app-component-card>